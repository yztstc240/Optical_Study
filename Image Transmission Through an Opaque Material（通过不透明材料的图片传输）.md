# Image Transmission Through an Opaque Material（通过不透明材料的图像传输）

## 绪论

&emsp;&emsp;传统认知中，由于光线在传输过程中通过复杂介质会发生多次散射，降低光传播可达深度以及成像分辨率，因此人们认为这种介质是不透明的。本文通过实验证明我们可以通过测量传输通道中的信息以实现通过不透明介质是高保真传输图像

## 介绍先前试验成果

&emsp;&emsp;该部分介绍了之前的试验成果。在经典光学系统中散射介质使得光发出多次散射，只能获得散斑图像，浑浊介质的大多成像主要依赖弹道光子。近期的实验表明波前控制可以利用多重散射进行成像。多重散射并不会造成信息丢失，可以通过传输矩阵逆向恢复图像。

    波前控制技术可以通过逆向传播算法来实现多重散射成像。具体而言，逆向传播算法通过向后传播一个反射场来估计出每个散射点的相位畸变，然后根据这些相位畸变来精确地控制波前传播方向，从而实现对多重散射的成像。这种方法可以在非常短的时间内获得高分辨率的成像结果，并且可以用于探测深度达到几个散射长度的多重散射媒介。此外，波前控制技术还可以与其他成像技术结合使用，如全息成像和压缩成像等，以进一步提高成像质量和效率。

## 如何通过传输矩阵进行图像恢复

### 传输矩阵的定义与测量

#### 定义

&emsp;&emsp;我们定义给定波长下的光学系统的介观透射矩阵（TM）为复系数$k_{mn}$的矩阵K下列公式通过系数$k_{mn}$连接输入输出光场，给出输入输出之间的像素关系。对传输矩阵进行奇异值分解，可以给出系统输入输出的本征模态，奇异值为这些模态的振幅透射

    这些本征模式可以描述光线在系统内传输的特征，比如传输的路径、强度变化、偏振等等。通过对本征模式的分析，可以对光线在系统内的传输进行更深入的理解，同时也可以用于光学成像、反演等应用中。

![传输矩阵](https://i.ibb.co/PmwrdRM/image.png)

#### 测量

&emsp;&emsp;CCD记录SLM发送的多个波前，通过相移干涉法推断TM。处于多重散射状态的TM奇异值没有特殊的输入输出相关性，因此表明没有剩下弹道光子

    相移干涉术（Phase-Shifting Interferometry）是一种用于测量光学表面形貌、光学薄膜厚度等物理量的精密光学测量技术。该技术通过在不同时间点记录干涉图像并对其进行相位分析，从而获得被测量物体的相位信息，从而实现精密测量。在测量过程中，通过改变相对相位的差异，产生一组干涉图像，然后使用数学算法计算出物体的相位信息。

![实验装置](https://i.ibb.co/2W2TdKP/image.png)图1. 实验装置。一个532 nm激光通过空间光调制器(SLM)扩展并反射。激光束被相位调制，然后聚焦在多次散射样品上，输出强度散斑模式由CCD相机成像。L代表透镜，P代表偏振器，D代表光阑。要成像的对象直接由SLM合成，然后通过传输矩阵从输出散斑中重建。

### 图片的恢复过程

&emsp;&emsp;通过以上测量我们可以得到公式

![测量矩阵](https://i.ibb.co/XY9f351/image.png)

&emsp;&emsp;静态参考散斑的对角矩阵$S_{ref}$与输入和输出分别是SLM和CCD像素的传输矩阵相乘之后能得到一个测量矩阵，该矩阵足以恢复输入图像

&emsp;&emsp;利用传输矩阵来通过散射样本重建一个任意的图像，需要通过一定的权重组合来估计输入信号$E_{obj}$，以匹配噪声和透过的图像。不同来源的噪声会降低传输矩阵测量的准确性

## 两种恢复图像的方法

### 方法一：使用逆矩阵（或输入/输出像素比的伪逆矩阵）进行图像传输

    在图像重建中，通常使用稀疏基变换（如小波变换）来表示图像。在这种情况下，测量矩阵实际上是一个线性变换，它将稀疏表示映射到测量空间中。测量矩阵的逆矩阵在这里的作用是将测量空间中的观测结果映射回稀疏表示空间，从而还原出原始的图像。这是因为稀疏表示具有唯一性，并且稀疏性约束可以保证图像的重建精度。

&emsp;&emsp;该方法通过逆矩阵（伪逆矩阵）来进行图像传输，但如果$K_{obs}$的奇异值低于噪声水平，会导致强烈且异常的贡献，因此在无噪声环境下才能用这种方法进行完美的图像传输。

### 方法二：使用时间反演算子（Time Reversal）进行传输

    时间反演算子（Time Reversal Operator）是一种将信号或波场逆转并回放的算子，通常在声波或电磁波的传输和成像中使用。该算子基于时间对称性，即如果一个系统的动力学是可逆的，则在反演时间后系统仍然可以恢复到原始状态。时间反演算子利用了这一性质，通过将信号或波场记录下来，并将其按照逆序播放，可以在相同的介质中以逆向成像的方式重现原始信号或波场。

    相位共轭是一种光学技术，它通过测量物体发出的光线，将其反向传输回物体并在物体内部产生相位反转的波，来消除光学成像过程中由于散射和色散等因素引起的失真。

&emsp;&emsp;由于时间反演算子在噪声方面表现稳定，因此利用其强奇异值来最大化能量传输。它的单色对应物是其相位共轭（用于补偿色散），本方法使用厄米特共轭实现相位共轭。

![测量矩阵的厄米特共轭](https://i.ibb.co/rdVxkHD/image.png)

相乘得到的矩阵具有强对角线，但其他位置不为空。因此重建的保真度随着图像复杂度提升而迅速下降。

&emsp;&emsp;均方优化算子（MSO）由期望值E估计，可以最大幅度地减少传输误差

    该算法的目标是通过最小化误差平方和（即均方误差）来拟合给定数据，从而得到最佳的模型参数。具体地说，均方误差是指预测值与实际值之间的差的平方的平均值，而均方误差最小化的目标是让这个差距最小化，从而获得最佳的拟合效果。

![MSO算子](https://i.ibb.co/vBGxfLC/image.png)

其中对于输出像素上标准偏差为σ的实验噪声，W为

![参数w](https://i.ibb.co/ZcFFsRs/image.png)

在没有噪声的情况下，W减少为逆矩阵Kobs^-1，这在该配置中是最佳的。而对于非常高的噪声水平，它与转置共轭矩阵（相位共轭算子）成正比

## 通过提高自由度降低重构噪声的方法

    术语“自由度”指独立的参数或变量，可以被测量或控制。例如，在成像的背景下，自由度可以指输入像素的数量或可以测量的输出模式的数量。
    提高自由度可以降低环境噪声，是因为更多的自由度意味着更多的可控性和测量能力。增加自由度可以提供更多的信息来抵消环境噪声的影响，从而提高重建的信噪比和质量。

&emsp;&emsp;文中提出了两种提高自由度的方法：average over disorder以及增加输出模式M。

### average over disorder

    "Average over disorder" 在物理中通常指对具有随机性质的系统进行多次测量或模拟，然后对这些结果进行平均以获得平均行为或性质。在文中，"averaging over disorder realizations" 意味着对于同一样本但不同的随机失调实现（例如，不同的实验条件），对多个实现的结果进行平均以减少由于失调引入的噪声。

&emsp;&emsp;该方法通过使用随机相位掩码不同组合生成相同的“虚拟对象”以增加自由度，并对结果进行平均降低噪声。经过试验可以得出简单逆滤波即便平均后也无法重建图像，相位共轭则能收敛到75%。效果最好的Optimal MSO（最优均方优化）可以实现94%相关性，并且最优均方优化对弹道光的影响具有很强的鲁棒性。

![使用不同重构方法获得的实验图像以及与原始目标的相关性](https://i.ibb.co/YLvdfgQ/image.png)a和b是分别是原始目标和经过不透明介质后的典型输出散斑图像。c和f是分别使用相位共轭和MSO算子重构的单个实验图像，d、e和g是分别使用相位共轭、逆矩阵和MSO算子重构的平均40次“虚拟实验”图像。插图中的值是与原始目标a的相关性系数。h是重构图像Eimg和目标Eobj之间的相关系数，其关于√σ（线）的函数和Kobs的奇异值分布（柱形）的函数。结果是对100次随机扰动的“虚拟实验”进行平均得到的，√σ和奇异值在横坐标轴上共享相同的刻度。

### 增加CCD上记录的独立像素M增加自由度

&emsp;&emsp;输出图像的质量取决于输出模式的质量M，因此可以通过增加记录图像的大小来增加M。但因此M/M的比值γ会改变传输矩阵数据。如果在图像中最不效率的传输通道能量能超过噪声水平，则传输矩阵的记录就不会受到噪声影响，这样就可以使用伪逆矩阵进行图像恢复

    这里的“channels”指的是介质中光的不同传播路径或模式。光在介质中传播时，由于散射、反射等影响，光波会沿着各种路径穿过介质。这些不同的传播路径对应于介质中的不同模式，而这些模式可以被视为不同的“通道”，它们可以在输出端（CCD）被记录下来。如果记录的通道数量越多，那么我们就有更多的机会选择那些在介质中传播能量最强的通道，这样就可以更有效地传递信息并抵消噪声的影响。

### 伪逆矩阵还原方法与最优MSO在不同自由度情况下的重建质量

![输出检测模式数量的影响](https://i.ibb.co/k03BZVH/image.png)a. 输出像素与输入像素的不对称比例γ = M / N的相关系数，对于MSO（虚线）和伪逆（实线），没有任何平均。误差棒对应于10个实现结果的分散。b. γ的最小归一化奇异值的实验（实线）和Marcenko-Pastur预测（虚线）。水平线显示实验噪声水平√σopt。

&emsp;&emsp;增加自由度（即增加γ的值）可以大大提高重建图像的质量。当γ取最大值11时，重建图像的保真度达到了85％以上，而不需要任何平均处理。与此同时，最小奇异值λ0γ也随γ的增加而增加。当λ0γ>∼σopt时，伪逆方法等效于最优MSO方法。

&emsp;&emsp;但需要注意的是，实验测得的λ0γ始终小于其理论预测值。作者认为，这种偏差可以通过参考图案|Sref|的振幅来解释，因为参考图案的存在导致矩阵中出现了相关性。在随机矩阵理论中，人们已经知道相关性会影响具有相同分布的元素的矩阵的奇异值分解（SVD）过程。

## 在考虑弹道光情况下几种重建方法的对比

&emsp;&emsp;相位共轭的情况下，直达成分会出现高传输通道的强奇异值，不能有助于图像重建，但MSO能达到介于反演与相位共轭间的最佳状态，能够降低对图像重建没有有效贡献的通道的权重

实验将采集物镜移动到样品上较薄且不太均匀的区域，并记录下一些弹道光。

![传输通道对重建的影响](https://i.ibb.co/89PN69C/image.png)图中展示了Eimg和Eobj之间的相关系数，以及带有传输矩阵中弹道贡献的Kobs的奇异值分布，二者都是根据100次“虚拟实现”的随机数计算的，横坐标上√σ和奇异值共用一个刻度。其中相位共轭技术的重建结果受弹道贡献的严重影响，而MSO则不受影响。

&emsp;&emsp;横轴为奇异值与噪声归一化指数的大小，柱状图则为100次虚拟实现中不同奇异值与噪声的分布情况，曲线为不同奇异值的恢复程度

&emsp;&emsp;在这张图中，展示了弹道光对图像重建的影响。图中的横轴是奇异值的分布，纵轴是图像重建与原图之间的相关系数。可以看到，在伪逆矩阵情况下噪声严重影响图像的恢复程度，在相位共轭方法下，弹道光的存在会严重降低图像重建的质量；而在MSO方法下，弹道光对图像重建的影响较小，MSO方法对弹道光具有较强的抵抗能力。

&emsp;&emsp;通过和之前没有弹道贡献的实验进行对比可以发现，弹道贡献对使用相位共轭算子的图像恢复有较强的干扰能力
