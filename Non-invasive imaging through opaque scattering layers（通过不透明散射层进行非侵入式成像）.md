# Non-invasive imaging through opaque scattering layers（通过不透明散射层进行非侵入式成像）

## 绪论

&emsp;&emsp;目前提出的成像方法大多都是侵入式的，本文提出的方法通过激光扫描入射角并检测物体总荧光以通过算法获取目标图像，是一种非侵入式成像。

## 介绍目前非侵入式成像领域的现状

&emsp;&emsp;强散射介质允许光以漫射光晕通过，但会扰乱所有空间信息。通过门控技术分离弹道光可以在半透明介质上获取较清晰的图像。但对于更强的散射，介质对肉眼而言是不透明的，因此目前的非侵入式光学成像无法获得详细图像

## 介绍非侵入式成像的具体实现

![非侵入式成像系统示意图](https://i.ibb.co/RSrsZZ2/image.png)a，单色激光束以角度h照射透过厚度L的不透明层。一件荧光物体被隐藏在离层后6毫米的距离处。充电耦合器件（CCD）摄像机从散射层前方检测荧光信号。b，距离为6毫米的散射层与毫米级网格背景的照片。层后的网格完全被隐藏。c，前散射层测量到的荧光强度。单个荧光图像不包含物体形状信息。

实验过程：  
&emsp;&emsp;1.将荧光材料放置于散射介质后，激光照射散射层，并测得透过散射层的荧光量，以及物体荧光响应与散斑强度之间重叠的信息  
&emsp;&emsp;2.荧光强度（物体图像）为目标物体与散斑的卷积。平均九次不同入射角度扫描，对散斑S的不同实现进行平均，得到图像的自相关函数  
&emsp;&emsp;自相关仅包含物体各部分之间的相对距离信息，要获取物体的图像，需要对自相关函数进行反演，获得物体的光强分布从而得到物体图像  
&emsp;&emsp;测量过程中，我们使用一对扫描电镜扫描激光光束的入射角度h =（hx，hy）。尽管照射物体的散斑看起来可能是随机的，但实际上它包含了可以利用的相关性。记忆效应表明，如果改变光源的位置，那么光斑的形状不会发生变化，只是平移了一定的距离。这种性质可以被用于通过强散射介质传输图像信息。  
&emsp;&emsp;我们将比例常数设置为1，测得的荧光强度与入射角的关系由上式给出。其中*表示卷积  
![不同角度的荧光强度计算公式](https://i.ibb.co/gDk8Ymb/image.png)  
    这个公式是在文章中对荧光强度进行描述时使用的。I表示荧光强度，O表示物体的发射强度分布，S表示传输函数，表示散射物体的影响。在散射介质中，光束会发生散射、衍射等现象，导致原本的物体发射强度分布发生变化，传输函数S即描述了这种变化。因此，I可以表示为O与S的卷积，即：I = O ∗ S
    其中，*表示卷积运算。这个公式的物理意义是，荧光强度I是由物体O经过传输函数S的作用得到的，可以通过测量I来反推出物体O的信息。
![实验中检索隐藏目标的自相关](https://i.ibb.co/6tjwY9Q/image.png)a，随着入射角度h =（hx，hy）的变化，集成荧光强度I。 b，平均九次不同起始入射角度h0的扫描，对散斑S的不同实现进行平均，得到的自相关函数I ★ I。

### 对荧光强度自相关公式的解释

![荧光强度自相关展开](https://i.ibb.co/yhdqgK5/image.png)为了从散斑中区分出物体形状，我们计算测量强度的自相关积并得到上式。其中★是交叉相关乘积，而尖括号为散斑实现的平均值。因为散斑图案的平均自相关是一个尖峰函数，在这种情况下，我们实际上测量了物体的自相关函数，其分辨率由平均散斑尺寸给出。  
![荧光强度展开公式](https://i.ibb.co/yN2PdWN/image.png)通过数学运算可以将其分解为目标对象的自相关与散斑的自相关的卷积。卷积第一项为目标物体的自相关函数，第二项为平均散斑大小，其中W项为照明灯光，可以通过增加W接近衍射极限。最后一项乘性因子是为了保证当入射角变化不够小时，散斑图案不会相关性下降。从而有效限制了记忆范围与可用视场  
&emsp;&emsp;这个最终的（乘性）因子考虑了这样一个事实，即当激光入射角度的变化不够小时，散斑图案不仅旋转而且相关性下降，从而有效地限制了记忆范围，因此限制了可用的视场。（由于J1在（0，1）区间单调递增因此当θ变小时，J1会减小，因此需要分母为sinh函数的乘性因子作为一个较大的数限制）  
&emsp;&emsp;我们注意到磨砂玻璃漫射器实际上是单一散射层，因此具有非常大的记忆范围，同时完全不透明  
&emsp;&emsp;基于上式不依赖于散射层的详细散射特性，我们可以用于探测任何被完全不透明层遮挡的自相关函数  

### 通过反演自相关函数获取物体的光强分布从而恢复图像

![检测到的图像与隐藏对象的对比](https://i.ibb.co/MZDMjVx/image.png)图3 | 检测到的图像与隐藏对象的对比。a，没有散射层的情况下拍摄的物体荧光显微镜图像。b，我们从图2b中测量的自相关函数中发现的检测到的物体。甚至原始物体的强度不均匀性等细节都在检测到的图像中恢复了。

&emsp;&emsp;为了获得独立的I(θ)的测量结果用于对S的自相关取平均，每次都需要通过不同的入射角进行测量如果开始的角度之间的差异大于物体的角度大小，那么散斑的实现就是独立的。如果旋转角度过大，那么散斑的位置和形态会发生很大的变化，导致散斑的自相关与原始对象的自相关之间没有关联。因此，当起始角度差异过大时，无法通过散斑相关方法来重建对象的图像。  
&emsp;&emsp;自相关仅包含有关物体各个部分之间的相对距离的信息，而不是直接关于物体本身的信息。  
&emsp;&emsp;实际物体的自相关函数总是居中和中心对称的。要获得物体的图像，我们需要对自相关函数进行反演。即计算出自相关函数的傅里叶变换并取其模的平方。这将给出物体的光强分布，从而得到物体的图像。  
&emsp;&emsp;在二维和三维中，可以利用Gerchberg-Saxton类型的迭代算法，通过利用测量信号的某些显著特性作为约束条件，对自相关进行数值反演。
    Gerchberg-Saxton算法是一种用于重建图像的迭代算法。该算法使用了物体的幅度和相位信息，以及被一个或多个透镜或透明介质散射后的幅度信息，通过反复迭代来重建出原始物体的图像。  

## 使用复杂的生物样品验证该方法

![复杂生物结构的重构](https://i.ibb.co/nk3wM7P/image.png)图4 | 复杂生物结构的重构a，穿过后向扩散器观察到的C. majalis样品自发荧光。b，五次扫描平均得到的测量自相关。c，移除后向扩散器并对许多（约200）散斑照明平均得到的结构荧光图像。蓝线是重建物体的轮廓（在最大强度的20%处）。d，重建的物体。所有原始物体中的高强度特征都被恢复。颜色刻度与图3相同。

&emsp;&emsp;当样品被斑点光照射时发出的光是从后扩散器后面收集的（图 4a），在对五次扫描进行平均后，我们获得了图 4b 中所示的自相关。  
&emsp;&emsp;图 4c 和 4d 分别显示了在移除后扩散器（从而允许自由光学访问）的情况下拍摄的样本图像和从测量的自相关开始获得的重建图像。在图4c中，蓝色线是重建图像在最大强度的20％处的轮廓线，显示出对象的所有高强度特征都被准确地恢复了。  
&emsp;&emsp;为了降低重建的复杂度，我们通过增加散斑尺寸来降低分辨率。通过减小散斑斑点的尺寸，可以获得更高的分辨率（最高可达衍射极限）。重建保真度的主要限制是背景信号，它可能会扭曲测量到的自相关函数。  

## *相关概念理解*

### 散斑的记忆效应

&emsp;&emsp;相干光被杂乱介质散射后会产生条纹状的亮暗斑点，称为散斑，而不再是一个直射光束。尽管散斑看起来是随机的，但它仍然保留着关于入射光和散射介质的信息，以相关的形式存在。其中最显著的现象之一是所谓的记忆效应，即改变入射光线的入射角度∆θ并不会完全改变散斑图案。对于小角度，散斑图案基本上没有变化，只是旋转了相同的角度∆θ。对于较大的角度，散斑图案会逐渐被修改，与∆θ = 0时的散斑图案的相关性会持续衰减。

### 为什么本文要使用自相关进行图像恢复？

&emsp;&emsp;自相关函数可以用于恢复图像，因为它包含了图像中各个部分之间的相关性信息。在图像中，不同的像素值之间可能存在一定的相关性，例如相邻像素值之间的相关性较强。这种相关性可以用自相关函数来描述。通过计算图像的自相关函数，可以得到各个像素值之间的相关性信息，从而可以利用这些信息进行图像恢复。  
&emsp;&emsp;具体来说，如果一个图像受到某种扰动（例如噪声、模糊等），则扰动会影响到各个像素值，使它们之间的相关性发生变化。通过计算图像的自相关函数，可以得到扰动前后各个像素值之间的相关性变化情况。根据这些相关性信息，可以尝试去除扰动并恢复原始图像。

